{% extends "base.html" %}

{% block head %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/profile.css') }}" />
{% endblock %}

{% block content %}
<div class="profile-container">
    <div class="profile-avatar-wrapper">
        {% if user.profile_pic %}
            <img src="{{ url_for('static', filename='profile_pics/' + user.profile_pic) }}" alt="{{ user.username }}" class="profile-avatar-img">
        {% else %}
            <div class="profile-avatar">
                {{ user.username[0].upper() }}
            </div>
        {% endif %}
    </div>

    <h2>{{ user.username }}</h2>
    
    <div class="profile-details">
        {% if user.email %}
            <p><strong>Email:</strong> {{ user.email }}</p>
        {% endif %}
        
        <p><strong>Bio:</strong> {{ user.bio if user.bio else "This user hasn't written a bio yet." }}</p>
    </div>

    <div class="profile-actions">
        
        {% if friendship_status == 'self' %}
            <a href="{{ url_for('account') }}" class="btn btn-dm">Edit Profile</a>

        {% elif friendship_status == 'friends' %}
            <a href="{{ url_for('dms', username=user.username) }}" class="btn btn-dm">Message</a>

        {% elif friendship_status == 'pending_sent' %}
            <button class="btn btn-back" disabled style="opacity: 0.7; cursor: default; background: rgba(255,255,255,0.05);">
                Request Pending
            </button>

        {% elif friendship_status == 'pending_received' %}
            <a href="{{ url_for('account') }}" class="btn btn-dm">Respond to Request</a>

        {% else %}
            <a href="{{ url_for('send_request', username=user.username) }}" class="btn btn-dm">Add Friend</a>

        {% endif %}

        <a href="javascript:history.back()" class="btn btn-back">Back</a>
    </div>
</div>
{% endblock %}